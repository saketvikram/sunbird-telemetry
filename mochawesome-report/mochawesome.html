<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:1,&quot;tests&quot;:20,&quot;passes&quot;:18,&quot;pending&quot;:0,&quot;failures&quot;:2,&quot;start&quot;:&quot;2021-02-12T02:43:49.723Z&quot;,&quot;end&quot;:&quot;2021-02-12T02:43:49.759Z&quot;,&quot;duration&quot;:36,&quot;testsRegistered&quot;:20,&quot;passPercent&quot;:90,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;bd3da427-a98b-4289-991f-83b79d57e105&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;title&quot;:&quot;Telemetry Helper Test Cases&quot;,&quot;fullFile&quot;:&quot;/Users/saket/Documents/evisas/uu-pull-commit/sb-telemetry/test/helpers/spec/telemetryHelper.spec.js&quot;,&quot;file&quot;:&quot;/test/helpers/spec/telemetryHelper.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return user spec error for without request&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should return user spec error for without request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;try {\n  const res = telemetryHelper.getUserSpec();\n} catch (error) {\n  const errorResponse = new TypeError(error)\n  expect(errorResponse.name).to.eql(&#x27;TypeError&#x27;);\n  done();\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a4aa5ae7-b90f-44f9-a8b1-ac1af64670f3&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return user spec based on req headers&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should return user spec based on req headers&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq.headers[&#x27;user-agent&#x27;] = testData.userAgent;\nconst res = telemetryHelper.getUserSpec(req);\nexpect(res).to.be.an(&#x27;object&#x27;);\nexpect(res).to.haveOwnProperty(&#x27;agent&#x27;);\nexpect(res[&#x27;agent&#x27;]).to.eql(&#x27;Chrome&#x27;);\nexpect(res).to.haveOwnProperty(&#x27;ver&#x27;);\nexpect(res[&#x27;ver&#x27;]).to.eql(&#x27;79&#x27;);\nexpect(res).to.haveOwnProperty(&#x27;system&#x27;);\nexpect(res[&#x27;system&#x27;]).to.eql(&#x27;Windows&#x27;);\nexpect(res).to.haveOwnProperty(&#x27;platform&#x27;);\nexpect(res[&#x27;platform&#x27;]).to.eql(&#x27;WebKit&#x27;);\nexpect(res).to.haveOwnProperty(&#x27;raw&#x27;);\nexpect(res[&#x27;raw&#x27;]).to.eql(testData.userAgent);\ndone();&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected &#x27;Blink&#x27; to deeply equal &#x27;WebKit&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected &#x27;Blink&#x27; to deeply equal &#x27;WebKit&#x27;\n    at Context.it (test/helpers/spec/telemetryHelper.spec.js:83:32)&quot;,&quot;diff&quot;:&quot;- Blink\n+ WebKit\n&quot;},&quot;uuid&quot;:&quot;f2f0e904-20fe-4ac7-a6b1-6945eb664070&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should start session start event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should start session start event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq.headers[&#x27;user-agent&#x27;] = testData.userAgent;\nreq[&#x27;session&#x27;] = {\n  userId: &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;,\n  rootOrghashTagId: &#x27;channel&#x27;,\n  orgs: [&#x27;ORG&#x27;, &#x27;PUBLIC&#x27;],\n  save: () =&gt; { return true; }\n};\ntelemetryHelper.logSessionStart(req, function () {\n  expect(spy.mockTelemetryStart).to.have.been.called();\n  let _startData = {\n    edata:\n      {\n        type: &#x27;click&#x27;,\n        mode: &#x27;mode&#x27;,\n        duration: 1000,\n        pageid: &#x27;profile&#x27;,\n        uaspec:\n          {\n            agent: &#x27;Chrome&#x27;,\n            ver: &#x27;79&#x27;,\n            system: &#x27;Windows&#x27;,\n            platform: &#x27;WebKit&#x27;,\n            raw: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79 Safari/537.36&#x27;\n          }\n      },\n    context:\n      {\n        channel: &#x27;channel&#x27;,\n        env: &#x27;user&#x27;,\n        did: undefined,\n        sid: undefined,\n        rollup: { l1: &#x27;ORG&#x27;, l2: &#x27;PUBLIC&#x27;, l3: &#x27;channel&#x27; }\n      },\n    actor: { id: &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;, type: &#x27;user&#x27; },\n    tags: [&#x27;channel&#x27;]\n  };\n  expect(spy.mockTelemetryStart).to.have.been.called.with(_startData);\n  done();\n});&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { Spy &#x27;object.start&#x27;, 1 call }\n(data) =&gt; { return data; } to have been called with [ Array(1) ]&quot;,&quot;estack&quot;:&quot;AssertionError: expected { Spy &#x27;object.start&#x27;, 1 call }\n(data) =&gt; { return data; } to have been called with [ Array(1) ]\n    at /Users/saket/Documents/evisas/uu-pull-commit/sb-telemetry/test/helpers/spec/telemetryHelper.spec.js:127:62\n    at Object.logSessionStart (telemetryHelper.js:63:5)\n    at Context.it (test/helpers/spec/telemetryHelper.spec.js:98:21)&quot;},&quot;uuid&quot;:&quot;d41e286c-b401-4f2e-9a47-92581de36b48&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should start session end event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should start session end event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq[&#x27;sessionID&#x27;] = &#x27;dK0-14e-apyYA86Yolmc.fQyOhLpLaZmLJvaRaeae0&#x27;;\nreq[&#x27;session&#x27;] = {\n  userId: &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;,\n  rootOrghashTagId: &#x27;channel&#x27;,\n  orgs: [&#x27;ORG&#x27;, &#x27;PUBLIC&#x27;],\n  deviceId: testData.deviceId\n};\ntelemetryHelper.logSessionEnd(req);\nexpect(spy.mockTelemetryEnd).to.have.been.called();\nlet _endData = {\n  edata:\n  {\n    type: &#x27;click&#x27;,\n    mode: &#x27;mode&#x27;,\n    duration: 1000,\n    pageid: &#x27;profile&#x27;,\n    summary: &#x27;logout&#x27;\n  },\n  context:\n  {\n    channel: &#x27;channel&#x27;,\n    env: &#x27;user&#x27;,\n    did: &#x27;f0bb2c64c266047b72a794afdcee92&#x27;,\n    sid: &#x27;dK0-14e-apyYA86Yolmc.fQyOhLpLaZmLJvaRaeae0&#x27;,\n    rollup: { l1: &#x27;ORG&#x27;, l2: &#x27;PUBLIC&#x27; }\n  },\n  actor: { id: &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;, type: &#x27;user&#x27; },\n  tags: [&#x27;channel&#x27;]\n};\nexpect(spy.mockTelemetryEnd).to.have.been.called.with(_endData);\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b0d8213-758b-4f20-8652-6fdb10f175c9&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should generate SSO start event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should generate SSO start event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq[&#x27;sessionID&#x27;] = &#x27;dK0-14e-apyYA86Yolmc.fQyOhLpLaZmLJvaRaeae0&#x27;;\nreq[&#x27;session&#x27;] = {\n  userId: &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;,\n  rootOrghashTagId: &#x27;channel&#x27;,\n  orgs: [&#x27;ORG&#x27;, &#x27;PUBLIC&#x27;],\n  deviceId: testData.deviceId\n};\nreq[&#x27;query&#x27;][&#x27;token&#x27;] = testData.deviceId;\ntelemetryHelper.logSSOStartEvent(req);\nexpect(spy.mockTelemetryStart).to.have.been.called();\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1eee73f1-5f38-4507-b103-739f49e226ff&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should generate SSO end event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should generate SSO end event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq[&#x27;session&#x27;] = {\n  rootOrghashTagId: &#x27;channel&#x27;\n};\nreq[&#x27;query&#x27;][&#x27;token&#x27;] = testData.deviceId;\ntelemetryHelper.logSSOEndEvent(req);\nexpect(spy.mockTelemetryEnd).to.have.been.called();\nlet _endData = {\n  edata:\n  {\n    type: &#x27;click&#x27;,\n    mode: &#x27;mode&#x27;,\n    duration: 1000,\n    pageid: &#x27;profile&#x27;,\n    summary: &#x27;logout&#x27;\n  },\n  actor: { id: &#x27;f0bb2c64c266047b72a794afdcee92&#x27;, type: &#x27;user&#x27; },\n  tags: [&#x27;channel&#x27;]\n};\nexpect(spy.mockTelemetryEnd).to.have.been.called.with(_endData);\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ba5b2a82-3275-49b0-ad91-e8c845648076&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return params data for log event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should return params data for log event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = telemetryHelper.getParamsData(testData.options, testData.statusCode, testData.resp, testData.uri);\nexpect(res).to.be.an(&#x27;array&#x27;);\nexpect(res[0]).to.haveOwnProperty(&#x27;title&#x27;);\nexpect(res[1]).to.haveOwnProperty(&#x27;category&#x27;);\nexpect(res[2]).to.haveOwnProperty(&#x27;url&#x27;);\nexpect(res[3]).to.haveOwnProperty(&#x27;duration&#x27;);\nexpect(res[4]).to.haveOwnProperty(&#x27;status&#x27;);\nexpect(res[5]).to.haveOwnProperty(&#x27;protocol&#x27;);\nexpect(res[6]).to.haveOwnProperty(&#x27;method&#x27;);\nexpect(res[7]).to.haveOwnProperty(&#x27;req&#x27;);\nexpect(res[8]).to.haveOwnProperty(&#x27;rid&#x27;);\nexpect(res[9]).to.haveOwnProperty(&#x27;size&#x27;);\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da0f03ca-fa7b-44e7-a3ec-a9764d7a9a13&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should generate log for api call event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should generate log for api call event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq.id = &#x27;001&#x27;;\nreq.uri = testData.uri;\nreq.resp = testData.resp;\nreq.type = &#x27;POST&#x27;;\nreq.userId = &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;;\nreq.options = testData.options;\nreq.statusCode = testData.statusCode;\nreq[&#x27;reqObj&#x27;] = {\n  &#x27;session&#x27;: {\n    rootOrghashTagId: &#x27;channel&#x27;,\n    orgs: [&#x27;ORG&#x27;, &#x27;PUBLIC&#x27;]\n  },\n  sessionID: &#x27;dK0-14e-apyYA86Yolmc.fQyOhLpLaZmLJvaRaeae0&#x27;\n};\ntelemetryHelper.logAPICallEvent(req);\nexpect(spy.mockTelemetryLog).to.have.been.called();\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ca22057c-624c-474b-a88d-05d0727c9049&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should generate keyclock grant log event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should generate keyclock grant log event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq.userId = &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;;\nreq.success = true;\nreq[&#x27;reqObj&#x27;] = {\n  &#x27;session&#x27;: {\n    rootOrghashTagId: &#x27;channel&#x27;,\n    orgs: [&#x27;ORG&#x27;, &#x27;PUBLIC&#x27;]\n  },\n  sessionID: &#x27;dK0-14e-apyYA86Yolmc.fQyOhLpLaZmLJvaRaeae0&#x27;\n};\ntelemetryHelper.logGrantLogEvent(req);\nexpect(spy.mockTelemetryLog).to.have.been.called();\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7c6fb8eb-cc3a-4037-b634-ffce3662d682&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should log API access event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should log API access event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq.id = &#x27;001&#x27;;\nreq.uri = testData.uri;\nreq.resp = testData.resp;\nreq.type = &#x27;POST&#x27;;\nreq.userId = &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;;\nreq.options = testData.options;\nreq.statusCode = testData.statusCode;\nreq[&#x27;reqObj&#x27;] = {\n  &#x27;session&#x27;: {\n    rootOrghashTagId: &#x27;channel&#x27;,\n    orgs: [&#x27;ORG&#x27;, &#x27;PUBLIC&#x27;]\n  },\n  sessionID: &#x27;dK0-14e-apyYA86Yolmc.fQyOhLpLaZmLJvaRaeae0&#x27;\n};\ntelemetryHelper.logAPIAccessEvent(req);\nexpect(spy.mockTelemetryLog).to.have.been.called();\nexpect(spy.mockTelemetryRollUpData).to.have.been.called.with([ &#x27;ORG&#x27;, &#x27;PUBLIC&#x27;, &#x27;channel&#x27; ]);\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4f5a4a4a-68fc-4a83-a5f2-a56c8f6dac2f&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should log api error event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should log api error event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq.id = &#x27;001&#x27;;\nreq.uri = testData.uri;\nreq.resp = testData.resp;\nreq.type = &#x27;POST&#x27;;\nreq.userId = &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;;\nreq.options = testData.options;\nreq.statusCode = testData.statusCode;\nreq[&#x27;reqObj&#x27;] = {\n  &#x27;session&#x27;: {\n    rootOrghashTagId: &#x27;channel&#x27;,\n    orgs: [&#x27;ORG&#x27;, &#x27;PUBLIC&#x27;]\n  },\n  sessionID: &#x27;dK0-14e-apyYA86Yolmc.fQyOhLpLaZmLJvaRaeae0&#x27;\n};\ntelemetryHelper.logAPIErrorEvent(req);\nexpect(spy.mockTelemetryLog).to.have.been.called();\nexpect(spy.mockTelemetryGetActorData).to.have.been.called.with(req.userId, &#x27;user&#x27;);\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9cacc827-813e-4465-bde6-8c72fa0aa9b9&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should log api error event - logApiErrorEventV2&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should log api error event - logApiErrorEventV2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq.id = &#x27;001&#x27;;\nreq.uri = testData.uri;\nreq.resp = testData.resp;\nreq.type = &#x27;POST&#x27;;\nreq.userId = &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;;\nreq.options = testData.options;\nreq.statusCode = testData.statusCode;\nreq[&#x27;session&#x27;] = {\n  rootOrghashTagId: &#x27;channel&#x27;,\n  orgs: [&#x27;ORG&#x27;, &#x27;PUBLIC&#x27;]\n};\nconst options = {\n  edata: {\n    err: null,\n    errtype: null,\n    stacktrace: null\n  },\n  context: {\n    channel: null,\n    env: null,\n    cdata: null,\n    rollup: null,\n    did: null\n  }\n};\ntelemetryHelper.logApiErrorEventV2(req, options);\nexpect(spy.mockTelemetryError).to.have.been.called();\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3701d3f9-dafd-4832-8505-4457e4163b8f&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should log audit event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should log audit event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq.uri = testData.uri;\nreq.userId = &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;;\nreq.sessionID = &#x27;dK0-14e-apyYA86Yolmc.fQyOhLpLaZmLJvaRaeae0&#x27;;\nreq[&#x27;session&#x27;] = {\n  rootOrghashTagId: &#x27;channel&#x27;,\n  orgs: [&#x27;ORG&#x27;, &#x27;PUBLIC&#x27;]\n};\nconst options = {\n  edata: {\n    props: null,\n    state: null,\n    prevstate: null\n  },\n  context: {\n    channel: null,\n    env: null,\n    cdata: null,\n    rollup: null,\n    did: null,\n    sid: null\n  }\n};\ntelemetryHelper.logAuditEvent(req, options);\nexpect(spy.mockTelemetryAudit).to.have.been.called();\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4f328a38-ff0a-40e7-b5ec-f5e021211235&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should log impression event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should log impression event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq.uri = testData.uri;\nreq.userId = &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;;\nreq[&#x27;session&#x27;] = {\n  rootOrghashTagId: &#x27;channel&#x27;,\n  orgs: [&#x27;ORG&#x27;, &#x27;PUBLIC&#x27;]\n};\nconst options = {\n  edata: {\n    type: null,\n    subtype: null,\n    pageid: null,\n    uri: testData.uri,\n    visits: 12345\n  },\n  context: {\n    channel: null,\n    env: null,\n    cdata: null,\n    rollup: null,\n    did: null,\n    sid: null\n  }\n};\ntelemetryHelper.logImpressionEvent(req, options);\nexpect(spy.mockTelemetryImpression).to.have.been.called();\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa2c64ea-cde9-437b-a0c0-cfd42f3f7e08&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should log session event&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should log session event&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nconst res = generic.getResponseObject();\nreq[&#x27;session&#x27;] = {\n  sessionEvents: [],\n  save: () =&gt; { return true; }\n};\nreq.body[&#x27;event&#x27;] = &#x27;{\&quot;eid\&quot;:\&quot;INTERACT\&quot;,\&quot;ets\&quot;:1580900354165,\&quot;ver\&quot;:\&quot;3.0\&quot;}&#x27;;\ntelemetryHelper.logSessionEvents(req, res);\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;00a074e5-50a6-4aeb-84bf-db2e0c1981bd&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should get actor data for telemetry - for userId in session&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should get actor data for telemetry - for userId in session&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq[&#x27;session&#x27;] = {\n  userId: &#x27;2217bd20-47e7-11ea-8c77-b55095b87aaf&#x27;\n};\nconst _response = telemetryHelper.getTelemetryActorData(req);\nexpect(_response).to.be.an(&#x27;object&#x27;);\nexpect(_response).to.haveOwnProperty(&#x27;id&#x27;);\nexpect(_response).to.haveOwnProperty(&#x27;type&#x27;);\nexpect(_response[&#x27;type&#x27;]).to.eql(&#x27;user&#x27;);\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c00e6a76-4685-4033-8330-502e149737bb&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should get actor data for telemetry - for userId in headers&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should get actor data for telemetry - for userId in headers&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nreq.headers[&#x27;x-consumer-id&#x27;] = mockEnv.default_userid;\nreq.headers[&#x27;x-consumer-username&#x27;] = mockEnv.default_username;\nconst _response = telemetryHelper.getTelemetryActorData(req);\nexpect(_response).to.be.an(&#x27;object&#x27;);\nexpect(_response).to.haveOwnProperty(&#x27;id&#x27;);\nexpect(_response).to.haveOwnProperty(&#x27;type&#x27;);\nexpect(_response[&#x27;type&#x27;]).to.eql(&#x27;public&#x27;);\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b45e0eaf-9e83-43e7-98a2-7f0850d923a9&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should generate telemetry for proxy api&#x27;s - Learner Service&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should generate telemetry for proxy api&#x27;s - Learner Service&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nconst res = generic.getResponseObject();\nconst next = () =&gt; { };\ntelemetryHelper.generateTelemetryForLearnerService(req, res, next);\nexpect(req).to.haveOwnProperty(&#x27;telemetryEnv&#x27;);\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b92369d3-b32a-4038-b270-940458c58ca6&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should generate telemetry for proxy api&#x27;s - Content Service&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should generate telemetry for proxy api&#x27;s - Content Service&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody();\nconst res = generic.getResponseObject();\nconst next = () =&gt; { };\ntelemetryHelper.generateTelemetryForContentService(req, res, next);\nexpect(req).to.haveOwnProperty(&#x27;telemetryEnv&#x27;);\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0a62e256-daa3-4d47-8ae4-991e1a184918&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should generate telemetry for proxy&quot;,&quot;fullTitle&quot;:&quot;Telemetry Helper Test Cases should generate telemetry for proxy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const req = generic.constructReqBody({\n  headers: {\n    &#x27;x-device-id&#x27;: testData.deviceId\n  }\n});\nconst res = generic.getResponseObject();\nconst next = () =&gt; { };\nreq[&#x27;session&#x27;] = {\n  rootOrghashTagId: &#x27;channel&#x27;,\n  orgs: [&#x27;ORG&#x27;, &#x27;PUBLIC&#x27;]\n};\nreq.sessionID = &#x27;dK0-14e-apyYA86Yolmc.fQyOhLpLaZmLJvaRaeae0&#x27;;\ntelemetryHelper.generateTelemetryForProxy(req, res, next);\nexpect(spy.mockTelemetryLog).to.have.been.called();\ndone();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ad1c5cb-2e87-4427-a1bf-06752bc9fdeb&quot;,&quot;parentUUID&quot;:&quot;4a303de7-46c0-422c-bd58-bb02635da3bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a4aa5ae7-b90f-44f9-a8b1-ac1af64670f3&quot;,&quot;3b0d8213-758b-4f20-8652-6fdb10f175c9&quot;,&quot;1eee73f1-5f38-4507-b103-739f49e226ff&quot;,&quot;ba5b2a82-3275-49b0-ad91-e8c845648076&quot;,&quot;da0f03ca-fa7b-44e7-a3ec-a9764d7a9a13&quot;,&quot;ca22057c-624c-474b-a88d-05d0727c9049&quot;,&quot;7c6fb8eb-cc3a-4037-b634-ffce3662d682&quot;,&quot;4f5a4a4a-68fc-4a83-a5f2-a56c8f6dac2f&quot;,&quot;9cacc827-813e-4465-bde6-8c72fa0aa9b9&quot;,&quot;3701d3f9-dafd-4832-8505-4457e4163b8f&quot;,&quot;4f328a38-ff0a-40e7-b5ec-f5e021211235&quot;,&quot;fa2c64ea-cde9-437b-a0c0-cfd42f3f7e08&quot;,&quot;00a074e5-50a6-4aeb-84bf-db2e0c1981bd&quot;,&quot;c00e6a76-4685-4033-8330-502e149737bb&quot;,&quot;b45e0eaf-9e83-43e7-98a2-7f0850d923a9&quot;,&quot;b92369d3-b32a-4038-b270-940458c58ca6&quot;,&quot;0a62e256-daa3-4d47-8ae4-991e1a184918&quot;,&quot;4ad1c5cb-2e87-4427-a1bf-06752bc9fdeb&quot;],&quot;failures&quot;:[&quot;f2f0e904-20fe-4ac7-a6b1-6945eb664070&quot;,&quot;d41e286c-b401-4f2e-9a47-92581de36b48&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:28,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;8.3.0&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;6.2.1&quot;},&quot;marge&quot;:{&quot;version&quot;:&quot;5.1.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;mochawesome-report&quot;,&quot;reportTitle&quot;:&quot;sb-telemetry&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;mochawesome-report/assets&quot;,&quot;jsonFile&quot;:&quot;/Users/saket/Documents/evisas/uu-pull-commit/sb-telemetry/mochawesome-report/mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;/Users/saket/Documents/evisas/uu-pull-commit/sb-telemetry/mochawesome-report/mochawesome.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>